<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gift EXP</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {background:#111; color:white; text-align:center; font-family:sans-serif; padding:20px; margin:0;}
    h1 {color:#ffd700; margin:10px;}
    .stats {font-size:18px; margin:15px 0;}
    button {background:#e91e63; color:white; border:none; padding:15px 30px; font-size:20px; border-radius:12px; margin:10px; cursor:pointer;}
    #result {font-size:26px; margin:30px 0; min-height:100px;}
    .win {color:#00ff9d; animation:blink 1.5s infinite;}
    .lose {color:#ff5252;}
    #exp-bar {margin:20px auto; background:#333; border:2px solid #ffd700; border-radius:10px; height:25px; width:80%; max-width:400px;}
    #exp-progress {background:linear-gradient(to right, #ffd700, #ffaa00); height:100%; width:0%; border-radius:8px; transition:width 0.5s;}
    @keyframes blink {0%,100% {opacity:1;} 50% {opacity:0.7;}}
  </style>
</head>
<body>
  <h1>Gift EXP</h1>
  
  <div class="stats">
    –ë–∞–ª–∞–Ω—Å Stars: <span id="stars">0</span> ‚≠ê<br>
    EXP: <span id="exp">0</span> | –£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span>
  </div>
  
  <div id="exp-bar"><div id="exp-progress"></div></div>
  
  <p>–í—ã–±–µ—Ä–∏ –∫–µ–π—Å –∏ –∫—Ä—É—Ç–∏!</p>
  
  <button onclick="selectCase('stars')">Stars Case üéñÔ∏è (—à–∞–Ω—Å –Ω–∞ –º–Ω–æ–≥–æ ‚≠ê)</button><br>
  <button onclick="selectCase('gifts')">Gifts Case üéÅ (—Ä–µ–¥–∫–∏–µ –ø–æ–¥–∞—Ä–∫–∏)</button><br>
  <button onclick="selectCase('nfts')">NFTs Case üñºÔ∏è (TON NFT —à–∞–Ω—Å—ã)</button>

  <div id="result"></div>

  <script>
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();

    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    let stars = parseInt(localStorage.getItem('gift_exp_stars')) || 0;
    let exp = parseInt(localStorage.getItem('gift_exp_exp')) || 0;
    let level = Math.floor(exp / 100) + 1;

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
    document.getElementById('stars').innerHTML = stars;
    document.getElementById('exp').innerHTML = exp;
    document.getElementById('level').innerHTML = level;
    updateProgress();

    function updateProgress() {
      let progress = (exp % 100);
      document.getElementById('exp-progress').style.width = progress + '%';
    }

    function addExp(amount) {
      exp += amount;
      localStorage.setItem('gift_exp_exp', exp);
      document.getElementById('exp').innerHTML = exp;
      
      let newLevel = Math.floor(exp / 100) + 1;
      if (newLevel > level) {
        level = newLevel;
        document.getElementById('level').innerHTML = level;
        // –ë–æ–Ω—É—Å –∑–∞ —É—Ä–æ–≤–µ–Ω—å (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å)
        let bonusStars = 5 + level * 2; // +5 + –ø–æ 2 –∑–∞ –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å
        stars += bonusStars;
        localStorage.setItem('gift_exp_stars', stars);
        document.getElementById('stars').innerHTML = stars;
        alert(`–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å ${level}! –ë–æ–Ω—É—Å: +${bonusStars} Stars! üéâ`);
      }
      updateProgress();
    }

    function addStars(amount) {
      stars += amount;
      localStorage.setItem('gift_exp_stars', stars);
      document.getElementById('stars').innerHTML = stars;
    }

    function openCase(caseType) {
      document.getElementById('result').innerHTML = '–ö—Ä—É—Ç–∏—Ç—Å—è –∫–µ–π—Å... üî•üé∞üî•';
      
      setTimeout(() => {
        const chance = Math.random() * 100;
        let msg = '';
        let cls = 'lose';
        let wonStars = 0;

        if (caseType === 'stars') {
          if (chance < 5) { wonStars = 50; msg = `–î–∂–µ–∫–ø–æ—Ç! +${wonStars} Stars! üåüüåüüåü`; cls = 'win'; }
          else if (chance < 20) { wonStars = 10; msg = `–ö—Ä—É—Ç–æ! +${wonStars} Stars! ‚≠ê‚≠ê`; cls = 'win'; }
          else if (chance < 50) { wonStars = 3; msg = `–ù–µ–ø–ª–æ—Ö–æ: +${wonStars} Stars!`; cls = 'win'; }
          else { wonStars = 1; msg = `+${wonStars} Star... —Å—Ç–∞—Ä–∞–π—Å—è –¥–∞–ª—å—à–µ üòî`; cls = 'lose'; }
        } else if (caseType === 'gifts') {
          if (chance < 2) { msg = 'Rare Gift NFT! –ü–æ–ª—É—á–∏ –ø–æ–¥–∞—Ä–æ–∫ –≤ –ø—Ä–æ—Ñ–∏–ª—å (—Å–∏–º—É–ª—è—Ü–∏—è) üéÅüëë'; cls = 'win'; addStars(20); }
          else if (chance < 15) { msg = 'Common Gift! üéÅ –ó–∞—á—ë—Ç!'; cls = 'win'; addStars(5); }
          else { msg = '–ü—É—Å—Ç–æ... –ù–µ—Ç –ø–æ–¥–∞—Ä–∫–∞ üòî'; cls = 'lose'; }
        } else if (caseType === 'nfts') {
          if (chance < 1) { msg = 'Legendary TON NFT! üñºÔ∏èüî• (—Å–∏–º—É–ª—è—Ü–∏—è)'; cls = 'win'; addStars(30); }
          else if (chance < 10) { msg = 'Rare NFT! üñºÔ∏è –ö–ª–∞—Å—Å!'; cls = 'win'; addStars(10); }
          else { msg = 'Shard NFT... –æ–±—ã—á–Ω—ã–π –∫—É—Å–æ–∫ üòî'; cls = 'lose'; }
        }

        document.getElementById('result').innerHTML = `<span class="${cls}">${msg}</span>`;
        
        if (wonStars > 0) addStars(wonStars);
        
        addExp(10 + Math.floor(wonStars / 5)); // –ë–æ–ª—å—à–µ EXP –∑–∞ —Ö–æ—Ä–æ—à–∏–µ –≤—ã–∏–≥—Ä—ã—à–∏
      }, 2500);
    }

    function selectCase(type) {
      // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É: –µ—Å–ª–∏ Stars < —Ü–µ–Ω–∞ ‚Äî –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å (–ø–æ–∫–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ)
      openCase(type);
    }
  </script>
</body>
</html>
