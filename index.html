<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gift EXP - –∫–∞–∫ Gift Go</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {background:#0a0a1f; color:#e0e0ff; font-family:sans-serif; padding:0; margin:0;}
    .top-profile {background:#1a1a3a; padding:15px; display:flex; align-items:center; border-bottom:2px solid #ffd700;}
    .avatar {width:60px; height:60px; border-radius:50%; border:3px solid #00ffaa; margin-right:15px;}
    .name {font-size:1.4em; font-weight:bold;}
    .level {color:#ffd700; font-size:1.1em;}
    .balance {font-size:1.3em; margin:10px 0;}
    .recharge-btn {background:#00aaff; color:white; border:none; padding:12px; font-size:1.2em; border-radius:12px; width:100%; margin:10px 0;}
    .tabs {display:flex; justify-content:space-around; background:#111; padding:10px 0;}
    .tab-btn {background:none; border:none; color:#aaa; font-size:1.1em; padding:10px; cursor:pointer;}
    .tab-btn.active {color:#ffd700; border-bottom:3px solid #ffd700;}
    .content {padding:15px;}
    .bets {display:flex; flex-wrap:wrap; justify-content:center; margin:15px 0;}
    .bet-btn {background:#ff3366; color:white; border:none; padding:12px 20px; font-size:1.2em; border-radius:12px; margin:8px; cursor:pointer;}
    .bet-btn.active {background:#ffd700; color:#000;}
    .go-btn {background:#00ff88; color:#000; padding:15px; font-size:1.5em; border:none; border-radius:12px; width:100%; margin:20px 0; font-weight:bold;}
    #result {font-size:1.8em; margin:20px 0; text-align:center; font-weight:bold;}
    .win {color:#00ffaa; animation:blink 1s infinite;}
    .lose {color:#ff6666;}
    .history-list {list-style:none; padding:0;}
    .history-item {background:#1a1a3a; padding:10px; margin:8px 0; border-radius:8px;}
    @keyframes blink {0%,100% {opacity:1;} 50% {opacity:0.6;}}
  </style>
</head>
<body>
  <div class="top-profile">
    <img class="avatar" src="https://via.placeholder.com/60?text=Av" alt="Avatar">
    <div>
      <div class="name">–¢–≤–æ–π –ù–∏–∫ <span style="color:#ff3366;">üçÖ</span></div>
      <div class="level">–£—Ä. <span id="level">1</span></div>
    </div>
  </div>

  <div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="stars">50</span> ‚òÖ</div>
  <button class="recharge-btn">–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å</button>

  <div style="background:#1a1a3a; margin:15px; padding:15px; border-radius:12px;">
    –ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π 10% –æ—Ç –∏—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤!
    <button style="background:#00aaff; color:white; padding:12px; border:none; border-radius:12px; width:100%; margin-top:10px;">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–∑–µ–π</button>
  </div>

  <div class="tabs">
    <button class="tab-btn active" onclick="showTab('play')">–ò–≥—Ä–∞—Ç—å</button>
    <button class="tab-btn" onclick="showTab('gifts')">–ü–æ–¥–∞—Ä–∫–∏</button>
    <button class="tab-btn" onclick="showTab('friends')">–î—Ä—É–∑—å—è</button>
    <button class="tab-btn" onclick="showTab('history')">–ò—Å—Ç–æ—Ä–∏—è</button>
  </div>

  <div id="play" class="content">
    <div class="bets">
      <button class="bet-btn" data-bet="25">25 ‚òÖ</button>
      <button class="bet-btn" data-bet="50">50 ‚òÖ</button>
      <button class="bet-btn active" data-bet="100">100 ‚òÖ</button>
      <button class="bet-btn" data-bet="250">250 ‚òÖ</button>
    </div>
    <button class="go-btn" onclick="openCase()">–ú–Ω–µ –ø–æ–≤–µ–∑—ë—Ç, Go! <span id="current-bet">100</span> ‚òÖ</button>
    <div id="result"></div>
  </div>

  <div id="gifts" class="content" style="display:none;">
    <h3>–¢–≤–æ–∏ –ø–æ–¥–∞—Ä–∫–∏</h3>
    <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç —Ç–≤–æ–∏ –≤—ã–∏–≥—Ä–∞–Ω–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏ (–ø–æ–∫–∞ –ø—É—Å—Ç–æ)</p>
  </div>

  <div id="friends" class="content" style="display:none;">
    <h3>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ: 0 | –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: 0 ‚òÖ</h3>
    <p>–ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π –ø–æ —Å—Å—ã–ª–∫–µ –≤—ã—à–µ!</p>
  </div>

  <div id="history" class="content" style="display:none;">
    <h3>–ò—Å—Ç–æ—Ä–∏—è</h3>
    <ul id="history-list" class="history-list"></ul>
  </div>

  <script>
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();

    let stars = parseInt(localStorage.getItem('gift_exp_stars')) || 50;
    let exp = parseInt(localStorage.getItem('gift_exp_exp')) || 0;
    let level = Math.floor(exp / 100) + 1;
    let history = JSON.parse(localStorage.getItem('gift_exp_history')) || [];

    let currentBet = 100;

    document.querySelectorAll('.bet-btn').forEach(btn => {
      btn.onclick = () => {
        document.querySelectorAll('.bet-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentBet = parseInt(btn.dataset.bet);
        document.getElementById('current-bet').innerHTML = currentBet;
      };
    });

    function updateUI() {
      document.getElementById('stars').innerHTML = stars;
      document.getElementById('level').innerHTML = level;
      localStorage.setItem('gift_exp_stars', stars);
      localStorage.setItem('gift_exp_exp', exp);
      localStorage.setItem('gift_exp_history', JSON.stringify(history.slice(-10))); // –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10
    }

    function addHistory(action) {
      history.push(action);
      const list = document.getElementById('history-list');
      list.innerHTML = '';
      history.slice(-5).forEach(item => {
        const li = document.createElement('li');
        li.className = 'history-item';
        li.textContent = item;
        list.appendChild(li);
      });
    }

    function showTab(tab) {
      document.querySelectorAll('.content').forEach(c => c.style.display = 'none');
      document.getElementById(tab).style.display = 'block';
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
    }

    function openCase() {
      if (stars < currentBet) {
        alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ Stars!");
        return;
      }

      stars -= currentBet;
      addHistory(`–û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞ -${currentBet} ‚òÖ`);
      document.getElementById('result').innerHTML = '–ö—Ä—É—Ç–∏—Ç—Å—è... üé∞üî•';
      updateUI();

      setTimeout(() => {
        const rand = Math.random() * 100;
        let msg = '';
        let cls = 'lose';

        // –ü—Ä–∏–º–µ—Ä —à–∞–Ω—Å–æ–≤ –∫–∞–∫ –≤ —Å–∫—Ä–∏–Ω–µ
        if (rand < 0.44) { msg = 'Legendary Crystal! üî•'; cls = 'win'; stars += 1000; }
        else if (rand < 1.77) { msg = 'Epic Trophy! üèÜ'; cls = 'win'; stars += 500; }
        else if (rand < 3.1) { msg = 'Rare Diamond! üíé'; cls = 'win'; stars += 200; }
        else if (rand < 13.13) { msg = 'Uncommon Rose! üåπ'; cls = 'win'; stars += 50; }
        else { msg = 'Common Bear... üß∏'; cls = 'lose'; stars += 5; }

        document.getElementById('result').innerHTML = `<span class="${cls}">${msg}</span>`;
        addHistory(`${msg} +${stars - (stars - currentBet)} ‚òÖ`); // —É–ø—Ä–æ—â—ë–Ω–Ω–æ
        updateUI();
      }, 2500);
    }

    updateUI();
    showTab('play'); // —Å—Ç–∞—Ä—Ç –Ω–∞ –∏–≥—Ä–µ
  </script>
</body>
</html>
